-- 1. Определить остаток товара: "Весы для бумаги"
SELECT (SUM(заказано) - SUM(продано)) AS Остаток
FROM Ord_Sale
JOIN Goods ON Ord_Sale.код_товар = Goods.код_товар
WHERE наименования_продукта = 'Весы для бумаги';

-- 2. Выбрать телефоны заказчиков, у которых известно имя и отчество
SELECT телефон
FROM Customer
WHERE имя IS NOT NULL AND отчество IS NOT NULL;

-- 3. Найти код заказанных сегодня товаров
SELECT DISTINCT код_товар
FROM Ord_Sale
WHERE дата_заказа = CURDATE();

-- 4. В г. Москве выбрать предприятие, не расположенное на улице Суворовской
SELECT предприятие
FROM Customer
WHERE город = 'Москва' AND адрес NOT LIKE '%Суворовская%';

-- 5. Найти телефон заказчика с адресом: Зеленая, 2/3
SELECT телефон
FROM Customer
WHERE адрес = 'Зеленая, 2/3';

-- 6. Сколько заказано товара 0??29
SELECT SUM(заказано) AS Общее_количество
FROM Ord_Sale
WHERE код_товар LIKE '0__29';

-- 7. По скидке 1..% найдите предприятие
SELECT предприятие
FROM Postav
WHERE скидки LIKE '1%';

-- 8. Список: код товара и количество товара в минимальной партии, если цена на него не меньше 100000
SELECT код_товар, MIN(заказано) AS Мин_партия
FROM Ord_Sale
WHERE цена >= 100000
GROUP BY код_товар;

-- 9. Найти код покупателя, купившего 4.04.96г. товар в количестве 50 шт.
SELECT код_покупателя
FROM Ord_Sale
WHERE дата_продажи = '1996-04-04' AND продано = 50;

-- 10. Найти кредит предприятия БГПИ или телефон данного предприятия
SELECT кредит, телефон
FROM Customer
WHERE предприятие = 'БГПИ';

-- 11. Количество заказчиков по имени Сергей
SELECT COUNT(*) AS Количество
FROM Customer
WHERE имя = 'Сергей';

-- 12. Найти код заказчика, имеющего максимальную скидку
SELECT c.код_покупателя
FROM Customer c
JOIN Ord_Sale o ON c.код_покупателя = o.код_покупателя
JOIN Postav p ON o.код_поставщика = p.код_поставщика
ORDER BY p.скидки DESC
LIMIT 1;

-- 13. Найти код товара, имеющего минимальную цену
SELECT код_товар
FROM Ord_Sale
ORDER BY цена ASC
LIMIT 1;

-- 14. Найти средний кредит для предприятий, имеющих скидку 10%
SELECT AVG(c.кредит) AS AverageCredit
FROM Customer c
JOIN Ord_Sale o ON c.код_покупателя = o.код_покупателя
JOIN Postav p ON o.код_поставщика = p.код_поставщика
WHERE p.скидки = 10;

-- 15. Посчитать сумму кредитов заказчиков, имеющих максимальную скидку
SELECT SUM(c.кредит) AS TotalCredit
FROM Customer c
JOIN Ord_Sale o ON c.код_покупателя = o.код_покупателя
JOIN Postav p ON o.код_поставщика = p.код_поставщика
WHERE p.скидки = (SELECT MAX(скидки) FROM Postav);

-- 16. Для поставщика 1055 найти количество заказанного товара или минимальную партию
SELECT код_товар, SUM(заказано) AS Общее_количество, MIN(заказано) AS Мин_партия
FROM Ord_Sale
WHERE код_поставщика = 1055
GROUP BY код_товар;

-- 17. Объединить данные полей: фамилия и страна
SELECT CONCAT(фамилия, ', ', страна) AS Объединенное
FROM Customer;

-- 18. Если предприятие увеличило кредит на 50%, то увеличить скидку на 10%
UPDATE Customer
SET кредит = кредит * 1.5
WHERE предприятие IS NOT NULL;

UPDATE Postav
SET скидки = скидки + 10
WHERE код_поставщика IN (
    SELECT DISTINCT o.код_постащика
    FROM Ord_Sale o
    JOIN Customer c ON o.код_покупателя = c.код_покупателя
    WHERE c.предприятие IS NOT NULL

-- 19. Удалить из таблицы записи о предприятиях Украины
DELETE FROM Customer
WHERE страна = 'Украина';

-- 20. Удалить из таблицы записи о товарах по минимальной цене
DELETE FROM Ord_Sale
WHERE цена = (SELECT MIN(цена) FROM Ord_Sale);